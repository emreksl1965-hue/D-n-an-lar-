<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rabia & Emre - Anı Bırak</title>
<style>
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:url('https://images.unsplash.com/photo-1677176430564-96048900719c?q=80&w=1364&auto=format&fit=crop') no-repeat center center/cover;display:flex;align-items:center;justify-content:center;min-height:100vh}
  .container{width:90%;max-width:420px;padding:22px;border-radius:14px;background:rgba(255,255,255,0.75);backdrop-filter:blur(6px);box-shadow:0 6px 30px rgba(0,0,0,0.18)}
  h1{text-align:center;margin:0 0 14px;font-size:22px;color:#b22222}
  label{display:block;margin-top:10px;font-weight:600;color:#333;text-align:left}
  input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd;margin-top:6px;box-sizing:border-box;background:#fff}
  button{width:100%;padding:12px;margin-top:14px;border-radius:24px;border:none;background:linear-gradient(135deg,#ff7eb3,#ff758c);color:#fff;font-weight:700;cursor:pointer}
  .note{font-size:12px;color:#666;margin-top:8px}
  .thank{display:none;margin-top:12px;text-align:center;color:#2e8b57;font-weight:700}
</style>
</head>
<body>
  <div class="container">
    <h1>❤️ Rabia & Emre ❤️<br>Anı Bırak</h1>
    <form id="aniform">
      <label>Ad Soyad</label>
      <input name="name" required />
      <label>Fotoğraf Yükle</label>
      <input type="file" name="photo" accept="image/*" />
      <label>Video Yükle</label>
      <input type="file" name="video" accept="video/*" />
      <label>Mesaj Bırak</label>
      <textarea name="message" rows="4"></textarea>
      <button type="submit">Gönder</button>
      <div class="note">Not: Foto/Video yüklerken dosya boyutları büyükse biraz bekle.</div>
    </form>
    <div id="thank" class="thank">Teşekkürler! Mesaj ve dosyalarınız kaydedildi ❤️</div>
  </div>

<script>
const GAS_URL = "SCRIPT_URL_HERE"; // ===> buraya Apps Script Web App URL koyacaksın (aşağıda nasıl alacağın var)

async function fileToBase64(file){
  return new Promise((res, rej) => {
    if(!file) return res(null);
    const reader = new FileReader();
    reader.onload = () => {
      // result like "data:<mime>;base64,AAA..."
      const result = reader.result;
      const parts = result.split(',');
      res({ base64: parts[1], mime: file.type || 'application/octet-stream', name: file.name });
    };
    reader.onerror = rej;
    reader.readAsDataURL(file);
  });
}

document.getElementById('aniform').addEventListener('submit', async function(e){
  e.preventDefault();
  const form = e.target;
  const name = form.name.value.trim() || 'anonymous';
  const message = form.message.value || '';
  const photoFile = form.photo.files[0] || null;
  const videoFile = form.video.files[0] || null;

  try {
    // convert to base64
    const photo = await fileToBase64(photoFile);
    const video = await fileToBase64(videoFile);

    const payload = {
      name,
      message,
      timestamp: new Date().toISOString(),
      photo, // null or {base64, mime, name}
      video  // null or {base64, mime, name}
    };

    // Send as JSON
    const resp = await fetch(GAS_URL, {
      method: 'POST',
      mode: 'cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    if (!resp.ok) {
      const txt = await resp.text();
      throw new Error(txt || 'Server error');
    }

    form.style.display = 'none';
    document.getElementById('thank').style.display = 'block';
  } catch (err) {
    alert('Yükleme sırasında hata: ' + err.message);
    console.error(err);
  }
});
</script>
</body>
</html>
